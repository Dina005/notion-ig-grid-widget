<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body { margin: 0; font-family: 'Inter', sans-serif; text-align: center; }
        
        /* Centered Bio */
        .header { padding: 40px 20px 20px; }
        .username { font-size: 32px; font-weight: 800; margin: 0; }
        .display-name { font-size: 18px; font-weight: 600; margin: 10px 0; color: #000; }
        .link-text { color: #00376b; font-weight: 600; text-decoration: none; font-size: 16px; }

        /* Centered Highlights */
        #highlightsSection { display: none; justify-content: center; gap: 20px; margin: 20px 0 40px; }
        .high-circle { width: 77px; height: 77px; border-radius: 50%; border: 1px solid #dbdbdb; background: #fafafa; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .high-img { width: 100%; height: 100%; object-fit: cover; }
        .high-label { font-size: 12px; font-weight: 600; margin-top: 8px; color: #262626; }

        /* Grid & Settings */
        .top-nav { max-width: 935px; margin: 0 auto 20px; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .btn-black { background: black; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 700; cursor: pointer; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; max-width: 935px; margin: 0 auto; padding: 0 20px; }
        .post { aspect-ratio: 1/1; background: #b4b4a5; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .post img { width: 100%; height: 100%; object-fit: cover; }
        .map-mode .post img { display: none; }
        .no-content { color: rgba(255,255,255,0.4); font-size: 10px; font-weight: 800; text-transform: uppercase; }
        
        /* Dropdown */
        .menu { position: absolute; top: 50px; right: 0; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 15px; width: 220px; z-index: 100; text-align: left; border: 1px solid #eee; display: none; }
        .menu.open { display: block; }
    </style>
</head>
<body>

    <div class="header" id="bioSection">
        <h1 class="username" id="u">@username</h1>
        <p class="display-name" id="d">Display Name</p>
        <a href="#" class="link-text" id="l">link.com</a>
    </div>

    <div id="highlightsSection"></div>

    <div class="top-nav">
        <button class="btn-black" onclick="location.reload()">Refresh</button>
        <div style="position:relative">
            <button class="btn-black" style="padding: 10px;" onclick="document.getElementById('m').classList.toggle('open')">•••</button>
            <div class="menu" id="m">
                <div style="display:flex; justify-content:space-between; margin-bottom:10px">Show Bio <input type="checkbox" id="t-bio" checked onchange="refresh()"></div>
                <div style="display:flex; justify-content:space-between; margin-bottom:10px">Show Highlights <input type="checkbox" id="t-high" checked onchange="refresh()"></div>
                <div style="display:flex; justify-content:space-between">Content Map <input type="checkbox" id="t-map" onchange="refresh()"></div>
            </div>
        </div>
    </div>

    <div id="grid" class="grid"></div>

    <script>
        const API = "YOUR_WORKER_URL";
        let state = { posts: [], highlights: [], bio: {} };

        function refresh() {
            document.getElementById('bioSection').style.display = document.getElementById('t-bio').checked ? 'block' : 'none';
            document.getElementById('highlightsSection').style.display = document.getElementById('t-high').checked ? 'flex' : 'none';
            document.getElementById('grid').className = document.getElementById('t-map').checked ? 'grid map-mode' : 'grid';
            render();
        }

        async function init() {
            try {
                const r = await fetch(API);
                state = await r.json();
                document.getElementById('u').innerText = state.bio.username;
                document.getElementById('d').innerText = state.bio.displayName;
                document.getElementById('l').innerText = state.bio.linkDisplay;
                
                const hBox = document.getElementById('highlightsSection');
                hBox.innerHTML = state.highlights.map(h => `
                    <div style="display:flex; flex-direction:column; align-items:center">
                        <div class="high-circle">${h.image ? `<img src="${h.image}" class="high-img">` : `<span class="no-content" style="color:#8e8e93">No Content</span>`}</div>
                        <span class="high-label">${h.name}</span>
                    </div>
                `).join('');
                refresh();
            } catch(e) { render(); }
        }

        function render() {
            const grid = document.getElementById('grid');
            const items = state.posts.length > 0 ? state.posts : Array(6).fill(null);
            grid.innerHTML = items.map(i => `
                <div class="post">
                    ${i && i.imageUrl ? `<img src="${i.imageUrl}">` : ''}
                    <span class="no-content">${i ? i.name : 'No Content'}</span>
                </div>
            `).join('');
        }
        init();
    </script>
</body>
</html>
