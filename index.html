<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Content Planner</title>
    <style>
        :root {
            --bg: #ffffff;
            --pill-grey: #f5f5f7;
            --dark-accent: #2c2c2e;
            --text-main: #1d1d1f;
            --text-sub: #86868b;
        }

        body { margin: 0; font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text-main); }

        /* --- Header Controls --- */
        .header-main { max-width: 935px; margin: 20px auto 0; padding: 0 20px; display: flex; align-items: center; gap: 10px; }
        
        .refresh-btn { 
            background: var(--dark-accent); color: white; border: none; padding: 10px 20px; 
            border-radius: 10px; display: flex; align-items: center; gap: 8px; font-weight: 500; cursor: pointer; 
        }

        .toggle-filter-btn { 
            background: var(--pill-grey); border: none; width: 42px; height: 42px; 
            border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; 
        }
        .toggle-filter-btn.active { background: #e2e2e7; }

        /* --- Sliding Filter Bar --- */
        .filter-drawer { 
            max-width: 935px; margin: 10px auto; padding: 0 20px; 
            display: none; /* Hidden by default */
            gap: 15px; animation: slideDown 0.2s ease-out;
        }
        .filter-drawer.show { display: flex; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Custom Multi-Select Dropdowns --- */
        .custom-select { position: relative; width: 180px; }
        
        .select-trigger { 
            background: var(--pill-grey); padding: 10px 15px; border-radius: 10px; 
            font-size: 14px; font-weight: 500; display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }

        .options-pane { 
            position: absolute; top: 45px; left: 0; width: 220px; background: white; 
            border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: none; z-index: 100; padding: 10px;
        }
        .options-pane.open { display: block; }

        .option-item { 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 8px 10px; border-radius: 8px; cursor: pointer; font-size: 14px;
        }
        .option-item:hover { background: var(--pill-grey); }
        .option-item input { margin-right: 10px; cursor: pointer; }
        .count-tag { color: var(--text-sub); font-size: 12px; }

        /* --- Grid --- */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; max-width: 935px; margin: 20px auto; padding: 0 20px; }
        .post { position: relative; aspect-ratio: 1/1; background: #eee; overflow: hidden; }
        .post img { width: 100%; height: 100%; object-fit: cover; }
        
        .overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); 
            opacity: 0; transition: 0.3s; display: flex; flex-direction: column; justify-content: center; padding: 20px; color: white; pointer-events: none;
        }
        .post:hover .overlay { opacity: 1; }
    </style>
</head>
<body>

    <div class="header-main">
        <button class="refresh-btn" onclick="location.reload()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"></path><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
            Refresh
        </button>
        <button class="toggle-filter-btn" onclick="toggleFilterDrawer()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
        </button>
    </div>

    <div class="filter-drawer" id="filterDrawer">
        <div class="custom-select">
            <div class="select-trigger" onclick="togglePane('platformPane')">All Platforms <small>▾</small></div>
            <div class="options-pane" id="platformPane">
                <div class="option-item"><label><input type="checkbox" checked onchange="filterChange()"> All Platforms</label> <span class="count-tag">(18)</span></div>
                <div class="option-item"><label><input type="checkbox" value="instagram" onchange="filterChange()"> Instagram</label> <span class="count-tag">(3)</span></div>
                <div class="option-item"><label><input type="checkbox" value="tiktok" onchange="filterChange()"> Tiktok</label> <span class="count-tag">(3)</span></div>
            </div>
        </div>

        <div class="custom-select">
            <div class="select-trigger" onclick="togglePane('statusPane')">All Status <small>▾</small></div>
            <div class="options-pane" id="statusPane">
                <div class="option-item"><label><input type="checkbox" checked onchange="filterChange()"> All Status</label> <span class="count-tag">(18)</span></div>
                <div class="option-item"><label><input type="checkbox" value="In progress" onchange="filterChange()"> In progress</label> <span class="count-tag">(5)</span></div>
                <div class="option-item"><label><input type="checkbox" value="Not started" onchange="filterChange()"> Not started</label> <span class="count-tag">(3)</span></div>
            </div>
        </div>
    </div>

    <div id="grid" class="grid"></div>

    <script>
        const WORKER_URL = "https://notion-ig-grid-widget.dinazramadan2005.workers.dev/";
        let rawData = [];

        async function loadData() {
            const container = document.getElementById('grid');
            container.innerHTML = "<p style='text-align:center; color:#888;'>Loading Feed...</p>";
            try {
                const res = await fetch(WORKER_URL);
                rawData = await res.json();
                if (rawData.length === 0) container.innerHTML = "<p>No data returned from Worker. Check Notion sharing.</p>";
                renderGrid();
            } catch (e) {
                container.innerHTML = `<p>Error: ${e.message}</p>`;
            }
        }

        function toggleFilterDrawer() {
            const drawer = document.getElementById('filterDrawer');
            drawer.classList.toggle('show');
        }

        function togglePane(id) {
            document.querySelectorAll('.options-pane').forEach(p => { if(p.id !== id) p.classList.remove('open'); });
            document.getElementById(id).classList.toggle('open');
        }

        function filterChange() {
            // Placeholder for checkbox logic - re-triggers render
            renderGrid();
        }

        function renderGrid() {
            const container = document.getElementById('grid');
            let html = '';
            
            // Logic to handle empty or filtered data
            const displayData = rawData.length > 0 ? rawData : Array(12).fill(null);

            displayData.forEach(p => {
                if (p && p.imageUrl) {
                    html += `<div class="post">
                                <img src="${p.imageUrl}">
                                <div class="overlay">
                                    <strong>${p.name}</strong>
                                    <small>${p.status}</small>
                                </div>
                             </div>`;
                } else {
                    html += `<div class="post" style="background:#f9f9f9; display:flex; align-items:center; justify-content:center;">
                                <span style="color:#ccc; font-size:10px; font-weight:bold; letter-spacing:1px;">NO CONTENT</span>
                             </div>`;
                }
            });
            container.innerHTML = html;
        }

        // Close dropdowns if clicking outside
        window.onclick = function(event) {
            if (!event.target.closest('.custom-select')) {
                document.querySelectorAll('.options-pane').forEach(p => p.classList.remove('open'));
            }
        }

        loadData();
    </script>
</body>
</html>
